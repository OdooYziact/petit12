<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <template id="report_stockpicking_document" inherit_id="stock.report_delivery_document">

        <xpath expr="//table[1]" position="replace">
            <div class="row">
                <div t-if="o.origin" class="col-xs-2">
                    <strong>N° d'affaire</strong>
                    <p t-field="o.origin"/>
                </div>
                <div t-if="o.date" class="col-xs-2">
                    <strong>Date</strong>
                    <p t-field="o.date_done" t-if="o.state == 'done'" t-options='{"widget": "date"}'/>
                    <p t-else="" t-field="o.scheduled_date" t-options='{"widget": "date"}'/>
                </div>
                <div t-if="o.sale_id and o.sale_id.client_order_ref" class="col-xs-3">
                    <strong>N° commande client</strong>
                    <p t-field="o.sale_id.client_order_ref"/>
                </div>
            </div>
            <!-- References client -->
            <t t-if="o.repair_order_id">
                <h4>Vos références</h4>
                <table class="table table_references">
                    <tr t-foreach="o.repair_order_id.get_references_fields()" t-as="line">
                        <t t-foreach="line" t-as="elem">
                            <td width="25%">
                                <strong><span t-esc="elem['name']"/></strong> <span t-esc="elem['value']"/>
                            </td>
                        </t>
                    </tr>
                </table>
            </t>
            <!-- Caracteristiques techniques -->
            <t t-if="o.sale_id and o.sale_id.repair_order_id and o.sale_id.repair_order_id.specification_ids">
                <h4>Caractéristiques techniques du matériel</h4>
                <table class="table table-condensed table_caracteristiques">
                    <thead>
                        <tr>
                            <th>Libellé</th>
                            <th>Valeur</th>
                            <th>Unité</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="o.sale_id.repair_order_id.specification_ids" t-as="specification">
                            <tr>
                                <td><span t-field="specification.description"/></td>
                                <td><span t-field="specification.value"/></td>
                                <td><span t-field="specification.unit"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </t>
        </xpath>

        <xpath expr="//div[@name='customer_address']" position="replace">
            <div class="row" name="customer_address">
                <div class="col-xs-4 pull-right">
                    <div>
                        <span><strong>A l'attention de</strong></span>
                    </div>
                    <div t-if="o.sale_id and o.sale_id.partner_contact_id" name="partner_header">
                        <div t-field="o.sale_id.partner_contact_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                    </div>
                    <div t-if="not (o.sale_id and o.sale_id.partner_contact_id) and o.move_lines and o.move_lines[0].partner_id" name="partner_header">
                        <div t-field="o.move_lines[0].partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                    </div>
                    <div t-if="not (o.sale_id and o.sale_id.partner_contact_id) and not (o.move_lines and o.move_lines[0].partner_id) and o.partner_id" name="partner_header">
                        <div t-field="o.partner_id" t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
                    </div>
                </div>
            </div>
        </xpath>

        <xpath expr="//p[@t-if='o.backorder_id']" position="before">
            <div class="row" t-if="o.reception_person">
                <div class="col-xs-offset-9 col-xs-3">Réceptionné par <span t-field="o.reception_person.name"/></div>
            </div>
            <div class="row" t-if="o.is_signed">
                <span t-field="o.sign" t-field-options='{"widget": "image"}' class="col-xs-offset-8 col-xs-4"/>
            </div>
        </xpath>

    </template>



    <template id="report_stockpicking_document2" inherit_id="sale_stock.report_delivery_document_inherit_sale_stock">

        <xpath expr="//div[@t-if='o.sale_id.client_order_ref']" position="replace"/>

    </template>



    <template id="report_picking" inherit_id="stock.report_picking">

        <xpath expr="//table[1]" position="replace">
            <div class="row">
                <div t-if="o.origin" class="col-xs-2">
                    <strong>Commande (origine)</strong>
                    <p t-field="o.origin"/>
                </div>
                <div t-if="o.state" class="col-xs-2">
                    <strong>Etat</strong>
                    <p t-field="o.state"/>
                </div>
                <div t-if="o.date" class="col-xs-2">
                    <strong>Date d'engagement</strong>
                    <p t-field="o.date" t-options='{"widget": "date"}'/>
                </div>
                <div t-if="o.scheduled_date" class="col-xs-2">
                    <strong>Date planifiée</strong>
                    <p t-field="o.scheduled_date" t-options='{"widget": "date"}'/>
                </div>
                <div t-if="o.sale_id and o.sale_id.client_order_ref" class="col-xs-4">
                    <strong>Num commande</strong>
                    <p t-field="o.sale_id.client_order_ref"/>
                </div>
            </div>
        </xpath>

    </template>

</odoo>